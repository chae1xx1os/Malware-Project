rule my_first_rule
{
    meta:
        author = "Taeyang Kim"
        date = "2024-04-12"
        description = "YARA rule to detect specific characteristics in a test file"
        filetype = "test"
        sample_filetype = "pdf"
        yara_rule = "https://github.com/Yara-Rules/rules"

    strings:
        $upx = "UPX*"  // "UPX"로 시작하는 모든 문자열을 찾음
        $test = "notepad"
        $MZ_test = { 4D 5A }

    condition:
        $test and               // "notepad" 문자열이 파일에 존재하는지 확인
        $MZ_test at 0            // 파일의 시작 부분이 PE 파일 헤더인지 확인
        and $upx                // "UPX"로 시작하는 문자열이 존재하는지 확인
}
rule second_rule
{
    meta:
        author = "Taeyang Kim"
        date = "2024-04-12"
        description = "YARA rule to detect KERNEL32 in a test file"
        filetype = "test"
        sample_filetype = "pdf"
        yara_rule = "https://github.com/Yara-Rules/rules"

    strings:
        $kernel32 = "*KERNEL32*"  // "KERNEL32" 문자열을 포함하는 모든 문자열을 찾음

    condition:
        uint16(0) == 0x5A4D and   // 파일의 시작 부분이 PE 파일 헤더인지 확인
        $kernel32                 // "KERNEL32" 문자열이 파일에 존재하는지 확인
}
