import "pe"

rule detect_malware1 {
    meta:
        author = "Taeyang Kim"
        date = "2024-04-12"
        description = "YARA rule to detect specific characteristics in a test file"
        filetype = "test"
        sample_filetype = "pdf"
        yara_rule = "https://github.com/Yara-Rules/rules"

    strings:
        $upx = "UPX*"
        $test = "notepad"
        $MZ_test = { 4D 5A }
        $maliciousString1 = "malicious_pattern_1" ascii
        $maliciousString2 = "malicious_pattern_2" wide
        $maliciousString3 = "evil_string_3"

    condition:
        $test and
        $MZ_test at 0 and
        $upx and
        (
            $maliciousString1 or
            $maliciousString2 or
            $maliciousString3
        )
}

rule detect_malware2 {
    meta:
        author = "Taeyang Kim"
        date = "2024-04-12"
        description = "YARA rule to detect specific characteristics in a test file"
        filetype = "test"
        sample_filetype = "pdf"
        yara_rule = "https://github.com/Yara-Rules/rules"

    strings:
        $upx = "UPX*"
        $test = "notepad"
        $MZ_test = { 4D 5A }
        $maliciousString1 = "malicious_pattern_1" ascii
        $maliciousString2 = "malicious_pattern_2" wide

    condition:
        $test and
        $MZ_test at 0 and
        $upx and
        (
            $maliciousString1 or
            $maliciousString2
        ) and
        pe.number_of_sections >= 5 and
        pe.entry_point > 0x4000
}

rule detect_malware3 {
    meta:
        author = "Taeyang Kim"
        date = "2024-04-12"
        description = "YARA rule to detect specific characteristics in a test file"
        filetype = "test"
        sample_filetype = "pdf"
        yara_rule = "https://github.com/Yara-Rules/rules"

    strings:
        $upx = "UPX*"
        $test = "notepad"
        $MZ_test = { 4D 5A }
        $maliciousString1 = "malicious_pattern_1" ascii
        $maliciousString2 = "malicious_pattern_2" wide

    condition:
        $test and
        $MZ_test at 0 and
        $upx and
        (
            $maliciousString1 or
            $maliciousString2
        ) and
        all of them
}
