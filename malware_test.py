import yara

# Load YARA rules file
rules = yara.compile('/home/kty1895/Desktop/malware_rules.yar')

# Path to the malicious code file to analyze
malware_file_path = '/home/kty1895/Desktop/Malicious Code sample/test_data/0a1332f55c43a59f751862555af5cb81918ebc8b3ec036e4f20107fcbcb61fb3.pdf'

# Apply YARA rules to the file
matches = rules.match(malware_file_path)

if matches:
    print("Malicious code detected!")
    for match in matches:
        print(f"Related rule: {match.rule}")
else:
    print("No malicious code detected.")

