import requests, hashlib
from tkinter import filedialog

url = "https://www.virustotal.com/vtapi/v2/file/report"
api_key = "PRIVATE"

sel_file = filedialog.askopenfilename()

#해시값 계산
with open(sel_file, "rb") as f:
    a = f.read()
    b = hashlib.md5()
    b.update(a)
    hash_val = b.hexdigest()
print(hash_val)

#바이러스 토탈 API
parameters = {"apikey":api_key, "resource":hash_val}
response = requests.get(url, params=parameters)
result = response.json()

#결과 분류
md5 = result["md5"]
sha1 = result["sha1"]
sha256 = result["sha256"]
ahnlab = result["scans"]["AhnLab-V3"]["result"]
alyac = result["scans"]["ALYac"]["result"]
kaspersky = result["scans"]["Kaspersky"]["result"]
total = result["total"]
positives = result["positives"]

#결과 출력
print("MD5 : " + md5
      + "\nSHA1 : " + sha1
      + "\nSHA256 : " +sha256
      + "\nAhnLab : " + str(ahnlab)
      + "\nAlYac : " + str(alyac)
      + "\nKaspersky : " + str(kaspersky)
      + "\n"
      + "\nTotal AV Engines : " + str(total)
      + "\nDetected AV Engines : " + str(positives))
